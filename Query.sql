-- QUERY-1 (CONVEX-HULL CREATION)

CREATE TABLE NEAREST
(ID SERIAL, LOCATION geometry);


INSERT INTO NEAREST(LOCATION)
VALUES(ST_GeomFromText('POINT(-118.2888659 34.0324338)')),
(ST_GeomFromText('POINT(-118.2933875 34.0180606)')),
(ST_GeomFromText('POINT(-118.2940507 34.025635)')),
(ST_GeomFromText('POINT(-118.2825227 34.022263)')),
(ST_GeomFromText('POINT(-118.2838941 34.0191765)')),
(ST_GeomFromText('POINT(-118.2879678 34.0188291)')),
(ST_GeomFromText('POINT(-118.2916626 34.0194804)')),
(ST_GeomFromText('POINT(-118.2792812 34.0270941)')),
(ST_GeomFromText('POINT(-118.2852273 34.0308765)'));


SELECT ST_AsText(ST_ConvexHull(
	ST_Collect(
		location
			) )) FROM NEAREST;


-- ANSWER
-- "POLYGON((-118.2933875 34.0180606,-118.2940507 34.025635,
-- -118.2888659 34.0324338,-118.2852273 34.0308765,-118.2792812 34.0270941,
-- -118.2838941 34.0191765,-118.2933875 34.0180606))"

-- QUERY-2 (3 NEAREST NEIGHBORS)

CREATE TABLE NEAREST
(ID SERIAL, LOCATION geometry);


INSERT INTO NEAREST(LOCATION)
VALUES(ST_GeomFromText('POINT(-118.2888659 34.0324338)')),
(ST_GeomFromText('POINT(-118.2933875 34.0180606)')),
(ST_GeomFromText('POINT(-118.2940507 34.025635)')),
(ST_GeomFromText('POINT(-118.2825227 34.022263)')),
(ST_GeomFromText('POINT(-118.2838941 34.0191765)')),
(ST_GeomFromText('POINT(-118.2879678 34.0188291)')),
(ST_GeomFromText('POINT(-118.2916626 34.0194804)')),
(ST_GeomFromText('POINT(-118.2792812 34.0270941)')),
(ST_GeomFromText('POINT(-118.2852273 34.0308765)'));


SELECT g2.id 
FROM nearest AS g1, nearest AS g2
WHERE g1.id=1 AND g1.id<>g2.id
ORDER BY ST_DISTANCE(g1.location,g2.location)
LIMIT 3